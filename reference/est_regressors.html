<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate the distribution of regressors, unconditional on the
  change point locations — est_regressors • LDATS</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Estimate the distribution of regressors, unconditional on the
  change point locations — est_regressors" />

<meta property="og:description" content="This function uses the marginal posterior distributions of
  the change point locations (estimated by est_changepoints)
  in combination with the conditional (on the change point locations) 
  posterior distributions of the regressors (estimated by
  multinom_TS) to estimate the marginal posterior 
  distribution of the regressors, unconditional on the change point 
  locations." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LDATS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/LDATS_codebase.html">Latent Dirichlet Allocation Time Series (LDATS)</a>
    </li>
    <li>
      <a href="../articles/paper-comparison.html">Comparison to Christensen et al. 2018</a>
    </li>
    <li>
      <a href="../articles/rodents-example.html">LDATS Rodents Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/weecology">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/weecology/LDATS">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate the distribution of regressors, unconditional on the
  change point locations</h1>
    <small class="dont-index">Source: <a href='https://github.com/weecology/LDATS/blob/master/R/TS.R'><code>R/TS.R</code></a></small>
    <div class="hidden name"><code>est_regressors.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function uses the marginal posterior distributions of
  the change point locations (estimated by <code><a href='est_changepoints.html'>est_changepoints</a></code>)
  in combination with the conditional (on the change point locations) 
  posterior distributions of the regressors (estimated by
  <code><a href='multinom_TS.html'>multinom_TS</a></code>) to estimate the marginal posterior 
  distribution of the regressors, unconditional on the change point 
  locations.</p>
    
    </div>

    <pre class="usage"><span class='fu'>est_regressors</span>(<span class='no'>rho_dist</span>, <span class='no'>data</span>, <span class='no'>formula</span>, <span class='no'>timename</span>, <span class='no'>weights</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>())</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>rho_dist</th>
      <td><p>List of saved data objects from the ptMCMC estimation of
change point locations (unless <code>nchangepoints</code> is 0, then 
<code>NULL</code>) returned from <code><a href='est_changepoints.html'>est_changepoints</a></code>.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p><code>data.frame</code> including [1] the time variable (indicated 
in <code>timename</code>), [2] the predictor variables (required by
<code>formula</code>) and [3], the multinomial response variable (indicated in
<code>formula</code>) as verified by <code><a href='check_timename.html'>check_timename</a></code> and 
<code><a href='check_formula.html'>check_formula</a></code>. Note that the response variables should be
formatted as a <code>data.frame</code> object named as indicated by the 
<code>response</code> entry in the <code>control</code> list, such as <code>gamma</code> 
for a standard TS analysis on LDA output.</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p><code><a href='https://www.rdocumentation.org/packages/stats/topics/formula'>formula</a></code> defining the regression between
relationship the change points. Any 
predictor variable included must also be a column in 
<code>data</code> and any (multinomial) response variable must be a set of
columns in <code>data</code>, as verified by <code><a href='check_formula.html'>check_formula</a></code>.</p></td>
    </tr>
    <tr>
      <th>timename</th>
      <td><p><code>character</code> element indicating the time variable
used in the time series.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Optional class <code>numeric</code> vector of weights for each 
document. Defaults to <code>NULL</code>, translating to an equal weight for
each document. When using <code>multinom_TS</code> in a standard LDATS 
analysis, it is advisable to weight the documents by their total size,
as the result of <code><a href='https://www.rdocumentation.org/packages/topicmodels/topics/lda'>LDA</a></code> is a matrix of 
proportions, which does not account for size differences among documents.
For most models, a scaling of the weights (so that the average is 1) is
most appropriate, and this is accomplished using <code>document_weights</code>.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A <code>list</code> of parameters to control the fitting of the
Time Series model including the parallel tempering Markov Chain 
Monte Carlo (ptMCMC) controls. Values not input assume defaults set by 
<code><a href='TS_control.html'>TS_control</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Matrix of draws (rows) from the marginal posteriors of the 
  coefficients across the segments (columns).</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The general approach follows that of Western and Kleykamp
  (2004), although we note some important differences. Our regression
  models are fit independently for each chunk (segment of time), and 
  therefore the variance-covariance matrix for the full model 
  has <code>0</code> entries for covariances between regressors in different
  chunks of the time series. Further, because the regression model here
  is a standard (non-hierarchical) softmax (Ripley 1996, Venables and 
  Ripley 2002, Bishop 2006), there is no error term in the regression  
  (as there is in the normal model used by Western and Kleykamp 2004), 
  and so the posterior distribution used here is a multivariate normal,
  as opposed to a multivariate t, as used by Western and Kleykamp (2004).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bishop, C. M. 2006. <em>Pattern Recognition and Machine Learning</em>. 
   Springer, New York, NY, USA.</p>
<p>Ripley, B. D. 1996. <em>Pattern Recognition and Neural Networks</em>. 
  Cambridge University Press, Cambridge, UK.</p>
<p>Venables, W. N. and B. D. Ripley. 2002. <em>Modern and Applied
  Statistics with S</em>. Fourth Edition. Springer, New York, NY, USA.</p>
<p>Western, B. and M. Kleykamp. 2004. A Bayesian change point model for 
  historical time series analysis. <em>Political Analysis</em>
  <strong>12</strong>:354-374.
  <a href='https://doi.org/10.1093/pan/mph023'>link</a>.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Juniper L. Simonis, Erica M. Christensen, David J. Harris, Renata M. Diaz, Hao Ye, Ethan P. White, S.K. Morgan Ernest.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

