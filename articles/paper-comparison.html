<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparison to Christensen et al. 2018 • LDATS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Comparison to Christensen et al. 2018">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LDATS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../rodents-example.html">Rodents example</a>
    </li>
    <li>
      <a href="../paper-comparison.html">Comparison to Christensen et al.</a>
    </li>
    <li>
      <a href="../articles/LDATS_codebase.html">LDATS codebase</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/weecology">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/weecology">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Comparison to Christensen et al. 2018</h1>
                        <h4 class="author">Renata Diaz and Hao Ye</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/weecology/LDATS/blob/master/vignettes/paper-comparison.Rmd"><code>vignettes/paper-comparison.Rmd</code></a></small>
      <div class="hidden name"><code>paper-comparison.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This document provides a side-by-side comparison of <strong><code>LDATS</code></strong> (version 0.2.6) results with analysis from <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1002/ecy.2373">Christensen et al. 2018</a>.</p>
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h2>
<table class="table">
<colgroup>
<col width="17%">
<col width="26%">
<col width="25%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th align="left">Step</th>
<th align="left">Changes from Christensen et al 2018 to <code>LDATS</code>
</th>
<th align="left">Effect on comparison</th>
<th align="left">Recommendations for future users</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Data</td>
<td align="left">Paper adjusts abundances according to unit effort, while <code>LDATS</code> uses raw capture numbers.</td>
<td align="left">None: run comparison using adjusted data</td>
<td align="left">Use raw, unweighted abundances.</td>
</tr>
<tr class="even">
<td align="left">LDA model selection</td>
<td align="left">Paper conservatively overestimated the number of parameters for calculating AIC for model selection. <code>LDATS</code> calculates AIC appropriately.</td>
<td align="left">Paper LDA selects 4 topics, while <code>LDATS</code> finds 6. Compare all combinations of paper and <code>LDATS</code> LDA models and changepoint models</td>
<td align="left">Use <code>LDATS</code> AIC calculation.</td>
</tr>
<tr class="odd">
<td align="left">Changepoint model document weights</td>
<td align="left">Paper weighted all sampling periods equally regardless of abundance. <code>LDATS</code> by default weights the information from each sampling period according to the number of individuals captured (i.e. the amount of information gleaned about the underlying community composition).</td>
<td align="left">None; use <code>weights = NULL</code> to set all weights equal to 1 for LDATS</td>
<td align="left">Weight sampling periods according to abundance</td>
</tr>
<tr class="even">
<td align="left">Overall LDA + changepoint results</td>
<td align="left">All combinations of LDA + changepoint model find 4 changepoints at approximately the same time steps</td>
<td align="left">Choice of LDA model has more of an effect than choice of changepoint model</td>
<td align="left">
<code>LDATS</code> reflects best practices, but the paper methods will produce qualitatively similar results.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<div id="ldats-installation" class="section level2">
<h2 class="hasAnchor">
<a href="#ldats-installation" class="anchor"></a>LDATS Installation</h2>
<p>To obtain the most recent version of <strong><code>LDATS</code></strong>, install the most recent version from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"weecology/LDATS"</span>)</a></code></pre></div>
<p>Load in the <strong><code>LDATS</code></strong> package.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(LDATS)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">nseeds &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">nit &lt;-<span class="st"> </span><span class="dv">10000</span></a></code></pre></div>
</div>
<div id="running-the-models" class="section level2">
<h2 class="hasAnchor">
<a href="#running-the-models" class="anchor"></a>Running the Models</h2>
<p>Because both the Latent Dirichlet Allocation (LDA) and time series components of the analysis can take a long time to run (especially with the settings above for the number of seeds and iterations), we will use pre-generated model outputs and turn off certain code chunks that run the models using a global <code>rmarkdown</code> parameter, <code>run_models = FALSE</code>.</p>
<p>To change this functionality, you can re-render this file with:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">rmarkdown<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rmarkdown/man/render.html">render</a></span>(<span class="st">"paper-comparison.Rmd"</span>, <span class="dt">params =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">run_models =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
</div>
<div id="download-analysis-scripts-and-data-files" class="section level2">
<h2 class="hasAnchor">
<a href="#download-analysis-scripts-and-data-files" class="anchor"></a>Download Analysis Scripts and Data Files</h2>
<p>We’re going to download analysis scripts, data files, and model objects, so we use a temporary location for storage:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">vignette_files &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span>()</a></code></pre></div>
<p>To replicate the Christensen et al. 2018 analysis, we download some of the original scripts &amp; data files from <a href="https://github.com/emchristensen/Extreme-events-LDA">Extreme-events-LDA repo</a>, as well as some raw data files from the <a href="https://github.com/weecology/PortalData">PortalData repo</a>:</p>
<p>Main Analysis Scripts:</p>
<ul>
<li>
<code>rodent_LDA_analysis.R</code>
<ul>
<li>main script for analyzing rodent community change using LDA</li>
</ul>
</li>
<li>
<code>rodent_data_for_LDA.R</code>
<ul>
<li>contains a function that creates the rodent data table used in analyses</li>
</ul>
</li>
<li>
<code>AIC_model_selection.R</code>
<ul>
<li>contains functions for calculating AIC for different candidate LDA models</li>
</ul>
</li>
<li>
<code>changepointmodel.r</code>
<ul>
<li>contains change-point model code</li>
</ul>
</li>
<li>
<code>LDA-distance.R</code>
<ul>
<li>function for computing Hellinger distance analyses</li>
</ul>
</li>
</ul>
<p>Data:</p>
<ul>
<li>
<code>Rodent_table_dat.csv</code>
<ul>
<li>table of rodent data, created by rodent_data_for_LDA.R</li>
</ul>
</li>
<li>
<code>moon_dates.csv</code>
<ul>
<li>table of census dates (downloaded from the PortalData repository)</li>
</ul>
</li>
<li>
<code>Portal_rodent_trapping.csv</code>
<ul>
<li>table of trapping effort (downloaded from the PortalData repository)</li>
</ul>
</li>
</ul>
<p>Figure scripts:</p>
<ul>
<li><code>LDA_figure_scripts.R</code></li>
<li>contains functions for making main plots in manuscript (Fig 1). Called from rodent_LDA_analysis.R</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">test_file &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"rodent_LDA_analysis.r"</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(test_file))</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">{</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  <span class="co"># from the Extreme-events-LDA repo</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  github_path &lt;-<span class="st"> "https://raw.githubusercontent.com/emchristensen/Extreme-events-LDA/master/"</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  files_to_download &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rodent_LDA_analysis.r"</span>, <span class="st">"rodent_data_for_LDA.r"</span>, </a>
<a class="sourceLine" id="cb5-8" data-line-number="8">                         <span class="st">"AIC_model_selection.R"</span>, <span class="st">"changepointmodel.r"</span>, </a>
<a class="sourceLine" id="cb5-9" data-line-number="9">                         <span class="st">"LDA-distance.R"</span>, <span class="st">"Rodent_table_dat.csv"</span>, </a>
<a class="sourceLine" id="cb5-10" data-line-number="10">                         <span class="st">"LDA_figure_scripts.R"</span>)</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb5-12" data-line-number="12">  <span class="cf">for</span> (file <span class="cf">in</span> files_to_download)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">  {</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">    <span class="kw"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span>(<span class="dt">url =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(github_path, file),</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">                  <span class="dt">destfile =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, file))</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">  }</a>
<a class="sourceLine" id="cb5-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb5-18" data-line-number="18">  <span class="co"># from the PortalData repo</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19">  github_path &lt;-<span class="st"> "https://raw.githubusercontent.com/weecology/PortalData/master/Rodents/"</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20">  files_to_download &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"moon_dates.csv"</span>, <span class="st">"Portal_rodent_trapping.csv"</span>)</a>
<a class="sourceLine" id="cb5-21" data-line-number="21">  </a>
<a class="sourceLine" id="cb5-22" data-line-number="22">  <span class="cf">for</span> (file <span class="cf">in</span> files_to_download)</a>
<a class="sourceLine" id="cb5-23" data-line-number="23">  {</a>
<a class="sourceLine" id="cb5-24" data-line-number="24">    <span class="kw"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span>(<span class="dt">url =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(github_path, file),</a>
<a class="sourceLine" id="cb5-25" data-line-number="25">                  <span class="dt">destfile =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, file))</a>
<a class="sourceLine" id="cb5-26" data-line-number="26">  }</a>
<a class="sourceLine" id="cb5-27" data-line-number="27">}</a></code></pre></div>
</div>
<div id="download-model-outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#download-model-outputs" class="anchor"></a>Download Model Outputs</h2>
<p>We also have pre-generated model outputs that we download from the <a href="https://github.com/weecology/LDATS-replications">LDATS-replications repo</a>:</p>
<p>LDA models:</p>
<ul>
<li>
<code>ldats_ldamodel.RDS</code>
<ul>
<li>the best LDA model as selected by LDATS</li>
</ul>
</li>
<li>
<code>paper_ldamodel.RDS</code>
<ul>
<li>the best LDA model as selected by the Christensen et al. analysis</li>
</ul>
</li>
</ul>
<p>Changepoint outputs</p>
<ul>
<li>
<code>ldats_ldats.RDS</code>
<ul>
<li>the posterior distribution of changepoints, using the LDATS LDA model and the LDATS changepoint selection</li>
</ul>
</li>
<li>
<code>ldats_paper.RDS</code>
<ul>
<li>the posterior distribution of changepoints, using the LDATS LDA model and the paper’s changepoint selection</li>
</ul>
</li>
<li>
<code>paper_ldats.RDS</code>
<ul>
<li>the posterior distribution of changepoints, using the paper LDA model and the LDATS changepoint selection</li>
</ul>
</li>
<li>
<code>paper_paper.RDS</code>
<ul>
<li>the posterior distribution of changepoints, using the paper LDA model and the paper’s changepoint selection</li>
</ul>
</li>
</ul>
<p>Figures</p>
<ul>
<li>
<code>lda_distances.png</code>
<ul>
<li>figure showing the variance in the topics identified by the paper’s LDA model code</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">test_file &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"ldats_ldamodel.RDS"</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(test_file))</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">{</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="co"># from the Extreme-events-LDA repo</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  github_path &lt;-<span class="st"> "https://raw.githubusercontent.com/weecology/LDATS-replications/master/model_outputs/"</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  files_to_download &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ldats_ldamodel.RDS"</span>, <span class="st">"paper_ldamodel.RDS"</span>, </a>
<a class="sourceLine" id="cb6-8" data-line-number="8">                         <span class="st">"ldats_ldats.RDS"</span>, <span class="st">"ldats_paper.RDS"</span>, </a>
<a class="sourceLine" id="cb6-9" data-line-number="9">                         <span class="st">"paper_ldats.RDS"</span>, <span class="st">"paper_paper.RDS"</span>, </a>
<a class="sourceLine" id="cb6-10" data-line-number="10">                         <span class="st">"lda_distances.png"</span>)</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"></a>
<a class="sourceLine" id="cb6-12" data-line-number="12">  <span class="cf">for</span> (file <span class="cf">in</span> files_to_download)</a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  {</a>
<a class="sourceLine" id="cb6-14" data-line-number="14">    <span class="kw"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span>(<span class="dt">url =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(github_path, file),</a>
<a class="sourceLine" id="cb6-15" data-line-number="15">                  <span class="dt">destfile =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, file), </a>
<a class="sourceLine" id="cb6-16" data-line-number="16">                  <span class="dt">mode =</span> <span class="st">"wb"</span>)</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">  }</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">}</a></code></pre></div>
</div>
</div>
<div id="data-comparison" class="section level1">
<h1 class="hasAnchor">
<a href="#data-comparison" class="anchor"></a>Data Comparison</h1>
<p>The dataset of Portal rodents on control plots is included in the LDATS package:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(rodents)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(rodents[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;   BA DM DO DS NA. OL OT PB PE PF PH PI PL PM PP RF RM RO SF SH SO</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; 1  0 13  0  2   2  0  0  0  1  1  0  0  0  0  3  0  0  0  0  0  0</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; 2  0 20  1  3   2  0  0  0  0  4  0  0  0  0  2  0  0  0  0  0  0</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; 3  0 21  0  8   4  0  0  0  1  2  0  0  0  0  1  0  0  0  0  0  0</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; 4  0 21  3 12   4  2  3  0  1  1  0  0  0  0  0  0  0  0  0  0  0</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; 5  0 16  1  9   5  2  1  0  0  2  0  0  0  0  0  0  1  0  0  0  0</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; 6  0 17  1 13   5  1  5  0  0  3  0  0  0  0  0  0  0  0  0  0  0</span></a></code></pre></div>
<p>We can compare this against the data used in Christensen et al:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># parameters for subsetting the full Portal rodents data</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">periods &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">436</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">control_plots &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">22</span>)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">species_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"BA"</span>, <span class="st">"DM"</span>, <span class="st">"DO"</span>, <span class="st">"DS"</span>, <span class="st">"NA"</span>, <span class="st">"OL"</span>, <span class="st">"OT"</span>, <span class="st">"PB"</span>, <span class="st">"PE"</span>, <span class="st">"PF"</span>, </a>
<a class="sourceLine" id="cb8-5" data-line-number="5">                  <span class="st">"PH"</span>, <span class="st">"PI"</span>, <span class="st">"PL"</span>, <span class="st">"PM"</span>, <span class="st">"PP"</span>, <span class="st">"RF"</span>, <span class="st">"RM"</span>, <span class="st">"RO"</span>, <span class="st">"SF"</span>, <span class="st">"SH"</span>, <span class="st">"SO"</span>)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"rodent_data_for_LDA.r"</span>))</a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co"># assemble `paper_dat`, the data from Christensen et al. 2018</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18">paper_dat &lt;-<span class="st"> </span><span class="kw">create_rodent_table</span>(<span class="dt">period_first =</span> <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(periods),</a>
<a class="sourceLine" id="cb8-19" data-line-number="19">                                 <span class="dt">period_last =</span> <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(periods),</a>
<a class="sourceLine" id="cb8-20" data-line-number="20">                                 <span class="dt">selected_plots =</span> control_plots,</a>
<a class="sourceLine" id="cb8-21" data-line-number="21">                                 <span class="dt">selected_species =</span> species_list)</a>
<a class="sourceLine" id="cb8-22" data-line-number="22"></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co"># assemble `paper_covariates`, the associated dates and covariate data</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24">moondat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"moon_dates.csv"</span>), <span class="dt">stringsAsFactors =</span> F)</a>
<a class="sourceLine" id="cb8-25" data-line-number="25"></a>
<a class="sourceLine" id="cb8-26" data-line-number="26">paper_dates &lt;-<span class="st"> </span>moondat <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(period <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/between.html">between</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(periods), <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(periods))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(censusdate) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>()</a>
<a class="sourceLine" id="cb8-30" data-line-number="30"></a>
<a class="sourceLine" id="cb8-31" data-line-number="31">paper_covariates &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</a>
<a class="sourceLine" id="cb8-32" data-line-number="32">  <span class="dt">index =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(paper_dates), </a>
<a class="sourceLine" id="cb8-33" data-line-number="33">  <span class="dt">date =</span> paper_dates, </a>
<a class="sourceLine" id="cb8-34" data-line-number="34">  <span class="dt">year_continuous =</span> lubridate<span class="op">::</span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/decimal_date.html">decimal_date</a></span>(paper_dates)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>( </a>
<a class="sourceLine" id="cb8-36" data-line-number="36">    <span class="dt">sin_year =</span> <span class="kw"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span>(year_continuous <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi), </a>
<a class="sourceLine" id="cb8-37" data-line-number="37">    <span class="dt">cos_year =</span> <span class="kw"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span>(year_continuous <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi)</a>
<a class="sourceLine" id="cb8-38" data-line-number="38">  )</a></code></pre></div>
<div id="compare-the-data-from-christensen-et-al-with-the-included-data-in-ldats" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-the-data-from-christensen-et-al-with-the-included-data-in-ldats" class="anchor"></a>Compare the data from Christensen et al. with the included data in <code>LDATS</code>
</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">compare &lt;-<span class="st"> </span>rodents[[<span class="dv">1</span>]] <span class="op">==</span><span class="st"> </span>paper_dat</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(compare) <span class="op">&lt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(compare)))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; [1] 16</span></a></code></pre></div>
<p>There are 16 rows where the data included in LDATS differs from the paper data. This is because the LDATS data is not adjusted to account for trapping effort, while the paper data does, by dividing all census counts by the actual number of plots trapped and multiplying by 8 to account for incompletely-trapped censuses.</p>
<p>To confirm this, refer to lines 36-46 in <code>rodent_data_for_LDA.r</code>:</p>
<pre><code>  # retrieve data on number of plots trapped per month
  trap_table = read.csv('https://raw.githubusercontent.com/weecology/PortalData/master/Rodents/Portal_rodent_trapping.csv')
  trap_table_controls = filter(trap_table, plot %in% selected_plots)
  nplots_controls = aggregate(trap_table_controls$sampled,by=list(period = trap_table_controls$period),FUN=sum)
  
  # adjust species counts by number of plots trapped that month
  r_table_adjusted = as.data.frame.matrix(r_table)
  for (n in 1:436) {
    #divide by number of control plots actually trapped (should be 8) and multiply by 8 to estimate captures as if all plots were trapped
    r_table_adjusted[n,] = round(r_table_adjusted[n,]/nplots_controls$x[n]*8)
  }</code></pre>
<p>We can run the same procedure on the LDATS data to verify that we obtain a data.frame that matches.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># get the trapping effort for each sample</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">trap_table &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"Portal_rodent_trapping.csv"</span>))</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">trap_table_controls &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(trap_table, plot <span class="op">%in%</span><span class="st"> </span>control_plots)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">nplots_controls &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(trap_table_controls<span class="op">$</span>sampled, </a>
<a class="sourceLine" id="cb11-5" data-line-number="5">                            <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">period =</span> trap_table_controls<span class="op">$</span>period), </a>
<a class="sourceLine" id="cb11-6" data-line-number="6">                            <span class="dt">FUN =</span> sum)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co"># adjust species counts by number of plots trapped that month</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#   divide by number of control plots actually trapped (should be 8) and </span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#   multiply by 8 to estimate captures as if all plots were trapped</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11">ldats_rodents_adjusted &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame.matrix</a></span>(rodents[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">ldats_rodents_adjusted[periods, ] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(ldats_rodents_adjusted[periods, ] <span class="op">/</span><span class="st"> </span>nplots_controls<span class="op">$</span>x[periods] <span class="op">*</span><span class="st"> </span><span class="dv">8</span>)</a></code></pre></div>
<p>Now we can compare the adjusted LDATS dataset with both the original ldats dataset and the dataset from the paper:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">compare_raw &lt;-<span class="st"> </span>rodents[[<span class="dv">1</span>]] <span class="op">==</span><span class="st"> </span>ldats_rodents_adjusted</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(compare_raw) <span class="op">&lt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(compare_raw)))</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; [1] 16</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">compare_adjusted &lt;-<span class="st"> </span>ldats_rodents_adjusted <span class="op">==</span><span class="st"> </span>paper_dat</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(compare_adjusted) <span class="op">&lt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(compare_adjusted)))</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; [1] 0</span></a></code></pre></div>
<p>Because the LDA procedure weights the information from documents (census periods) according to the number of words (rodents captured), we now believe it is most appropriate to run the LDA on <em>unadjusted</em> trapping data, and we recommend that users of LDATS do so. However, to maintain consistency with Christensen et al 2018, we will proceed using the <em>adjusted</em> rodent table in this vignette.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">rodents[[<span class="dv">1</span>]] &lt;-<span class="st"> </span>paper_dat</a></code></pre></div>
<p>The LDATS rodent data comes with a <code>document_covariate_table</code>, which we will use later as the predictor variables for the changepoint models. In this table, time is expressed as new moon numbers. Later we will want to be able to interpret the results in terms of census dates. We will add a column to the <code>document_covariate_table</code> to convert new moon numbers to census dates. We will not reference this column in any of the formulas we pass to the changepoint models, so it will be ignored until we need it.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(rodents<span class="op">$</span>document_covariate_table)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt;   newmoon sin_year cos_year</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; 1       1  -0.2470  -0.9690</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; 2       2  -0.6808  -0.7325</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; 3       3  -0.9537  -0.3008</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; 4       4  -0.9813   0.1925</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; 5       5  -0.7583   0.6519</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; 6       6  -0.3537   0.9354</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">new_cov_table &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(rodents<span class="op">$</span>document_covariate_table, </a>
<a class="sourceLine" id="cb14-11" data-line-number="11">                                  dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(moondat, newmoonnumber, censusdate), </a>
<a class="sourceLine" id="cb14-12" data-line-number="12">                                  <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"newmoon"</span> =<span class="st"> "newmoonnumber"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">date =</span> censusdate)</a>
<a class="sourceLine" id="cb14-14" data-line-number="14"></a>
<a class="sourceLine" id="cb14-15" data-line-number="15">rodents<span class="op">$</span>document_covariate_table &lt;-<span class="st"> </span>new_cov_table</a></code></pre></div>
</div>
</div>
<div id="identify-community-groups-using-lda" class="section level1">
<h1 class="hasAnchor">
<a href="#identify-community-groups-using-lda" class="anchor"></a>Identify community groups using LDA</h1>
<p>While LDATS can run start-to-finish with <code><a href="../reference/LDA_TS.html">LDATS::LDA_TS</a></code>, here we will work through the process function-by-function to isolate differences with the paper. For a breakdown of the <code>LDA_TS</code> pipeline, see the <a href="https://weecology.github.io/LDATS/articles/LDATS_codebase.html"><code>codebase</code> vignette</a>.</p>
<p>First, we run the LDA models from LDATS to identify the number of topics:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">ldats_ldas &lt;-<span class="st"> </span>LDATS<span class="op">::</span><span class="kw"><a href="https://weecology.github.io/ldats/reference/LDA_set.html">LDA_set</a></span>(<span class="dt">document_term_table =</span> rodents<span class="op">$</span>document_term_table, </a>
<a class="sourceLine" id="cb15-2" data-line-number="2">                             <span class="dt">topics =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nseeds =</span> nseeds)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">ldats_ldamodel &lt;-<span class="st"> </span>LDATS<span class="op">::</span><span class="kw"><a href="https://weecology.github.io/ldats/reference/select_LDA.html">select_LDA</a></span>(<span class="dt">LDA_models =</span> ldats_ldas)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(ldats_ldamodel, <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"ldats_ldamodel.RDS"</span>))</a></code></pre></div>
<p>Second, we run the LDA models from Christensen et al. to do the same task:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"AIC_model_selection.R"</span>))</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"LDA-distance.R"</span>))</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co"># Some of the functions require the data to be stored in the `dat` variable</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">dat &lt;-<span class="st"> </span>paper_dat</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co"># Fit a bunch of LDA models with different seeds</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co"># Only use even numbers for seeds because consecutive seeds give identical results</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9">seeds &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(nseeds)</a>
<a class="sourceLine" id="cb16-10" data-line-number="10"></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co"># repeat LDA model fit and AIC calculation with a bunch of different seeds to test robustness of the analysis</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12">best_ntopic &lt;-<span class="st"> </span><span class="kw">repeat_VEM</span>(paper_dat,</a>
<a class="sourceLine" id="cb16-13" data-line-number="13">                          seeds,</a>
<a class="sourceLine" id="cb16-14" data-line-number="14">                          <span class="dt">topic_min =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb16-15" data-line-number="15">                          <span class="dt">topic_max =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(best_ntopic<span class="op">$</span>k, <span class="dt">breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from =</span> <span class="fl">0.5</span>, <span class="dt">to =</span> <span class="fl">9.5</span>), </a>
<a class="sourceLine" id="cb16-17" data-line-number="17">     <span class="dt">xlab =</span> <span class="st">"best # of topics"</span>, <span class="dt">main =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb16-18" data-line-number="18"></a>
<a class="sourceLine" id="cb16-19" data-line-number="19"><span class="co"># 2b. how different is species composition of 4 community-types when LDA is run with different seeds?</span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="co"># ==================================================================</span></a>
<a class="sourceLine" id="cb16-21" data-line-number="21"><span class="co"># get the best 100 seeds where 4 topics was the best LDA model</span></a>
<a class="sourceLine" id="cb16-22" data-line-number="22">seeds_4topics &lt;-<span class="st"> </span>best_ntopic <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-23" data-line-number="23"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(k <span class="op">==</span><span class="st"> </span><span class="dv">4</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-24" data-line-number="24"><span class="st">  </span><span class="kw">arrange</span>(aic) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-25" data-line-number="25"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="dv">100</span>, nseeds)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-26" data-line-number="26"><span class="st">  </span><span class="kw">pull</span>(SEED)</a>
<a class="sourceLine" id="cb16-27" data-line-number="27"></a>
<a class="sourceLine" id="cb16-28" data-line-number="28"><span class="co"># choose seed with highest log likelihood for all following analyses</span></a>
<a class="sourceLine" id="cb16-29" data-line-number="29"><span class="co">#    (also produces plot of community composition for "best" run compared to "worst")</span></a>
<a class="sourceLine" id="cb16-30" data-line-number="30"></a>
<a class="sourceLine" id="cb16-31" data-line-number="31"><span class="kw"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"lda_distances.png"</span>), <span class="dt">width =</span> <span class="dv">800</span>, <span class="dt">height =</span> <span class="dv">400</span>)</a>
<a class="sourceLine" id="cb16-32" data-line-number="32">dat &lt;-<span class="st"> </span>paper_dat <span class="co"># calculate_LDA_distance has some required named variables</span></a>
<a class="sourceLine" id="cb16-33" data-line-number="33">best_seed &lt;-<span class="st"> </span><span class="kw">calculate_LDA_distance</span>(paper_dat, seeds_4topics)</a>
<a class="sourceLine" id="cb16-34" data-line-number="34"><span class="kw"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()</a>
<a class="sourceLine" id="cb16-35" data-line-number="35">mean_dist &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(best_seed)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb16-36" data-line-number="36">max_dist &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(best_seed)[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb16-37" data-line-number="37"></a>
<a class="sourceLine" id="cb16-38" data-line-number="38"><span class="co"># ==================================================================</span></a>
<a class="sourceLine" id="cb16-39" data-line-number="39"><span class="co"># 3. run LDA model</span></a>
<a class="sourceLine" id="cb16-40" data-line-number="40"><span class="co"># ==================================================================</span></a>
<a class="sourceLine" id="cb16-41" data-line-number="41">ntopics &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb16-42" data-line-number="42">SEED &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(best_seed)[<span class="dv">1</span>]  <span class="co"># For the paper, use seed 206</span></a>
<a class="sourceLine" id="cb16-43" data-line-number="43">ldamodel &lt;-<span class="st"> </span><span class="kw">LDA</span>(paper_dat, ntopics, <span class="dt">control =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">seed =</span> SEED), <span class="dt">method =</span> <span class="st">"VEM"</span>)</a>
<a class="sourceLine" id="cb16-44" data-line-number="44"></a>
<a class="sourceLine" id="cb16-45" data-line-number="45"><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(ldamodel, <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"paper_ldamodel.RDS"</span>))</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"lda_distances.png"</span>))</a></code></pre></div>
<p><img src="../../../../../../tmp/RtmpqrbTeq/lda_distances.png"><!-- --></p>
<div id="plots" class="section level2">
<h2 class="hasAnchor">
<a href="#plots" class="anchor"></a>Plots</h2>
<p>To visualize the LDA assignment of species to topics, we load in the saved LDA models from previously:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">ldamodel &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"paper_ldamodel.RDS"</span>))</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">ldats_ldamodel &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"ldats_ldamodel.RDS"</span>))</a></code></pre></div>
<p>How the paper LDA model assigns species to topics:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(ldamodel, <span class="dt">cols =</span> <span class="ot">NULL</span>, <span class="dt">option =</span> <span class="st">"D"</span>)</a></code></pre></div>
<p><img src="paper-comparison_files/figure-html/plot%20paper%20LDA-1.png" width="672"></p>
<p>How the LDATS LDA model assigns species to topics:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(ldats_ldamodel, <span class="dt">cols =</span> <span class="ot">NULL</span>, <span class="dt">option =</span> <span class="st">"D"</span>)</a></code></pre></div>
<p><img src="paper-comparison_files/figure-html/plot%20LDATS%20LDA-1.png" width="672"></p>
<p>The paper method finds 4 topics and LDATS finds 6. This is because of an update to the model selection procedure. The paper conservatively overestimates the number of parameters (by counting all of the variational parameters) and therefore overpenalizes the AIC for models with more topics. Comparatively, the LDATS method now uses the number of parameters remaining after the variational approximation, as returned by the LDA object. For this vignette, we will compare the results from using both LDA models.</p>
</div>
</div>
<div id="changepoint-models" class="section level1">
<h1 class="hasAnchor">
<a href="#changepoint-models" class="anchor"></a>Changepoint models</h1>
<p>We will compare four combinations of LDA + changepoint models:</p>
<ul>
<li>LDATS LDA + LDATS changepoint</li>
<li>LDATS LDA + paper changepoint</li>
<li>Paper LDA + LDATS changepoint</li>
<li>Paper LDA + paper changepoint</li>
</ul>
<p>Having divided the data to generate catch-per-effort, the paper changepoint model weighted all sample periods equally. In comparison, LDATS does not force an equal weighting, but assumes that as default, and can weight sample periods according to how many individuals were captured (controlled by the <code>weights</code> argument to <code>LDA_TS</code>, and easily calculated for a document-term matrix using <code>document_term_weights</code>. We now believe it is more appropriate to weight periods proportional to captures in the time series (despite the LDA function returning only proportions of each topic), and this is what we recommend for LDATS users. For the purposes of comparison, however, we will continue set all weights = 1 for both changepoint models. For an example of LDATS run with proportional weights, see the <a href="https://weecology.github.io/LDATS/articles/rodents-example.html">rodents vignette</a>.</p>
<div id="running-paper-changepoint-models" class="section level2">
<h2 class="hasAnchor">
<a href="#running-paper-changepoint-models" class="anchor"></a>Running paper changepoint models</h2>
<p>We define a few helper functions for running the changepoints model of Christensen et al. and processing the output to obtain the dates:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">#### Run changepoint ####</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"changepointmodel.r"</span>))</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">#&gt; Attaching package: 'lubridate'</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt; The following object is masked from 'package:base':</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt;     date</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt; Loading required package: viridisLite</span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"></a>
<a class="sourceLine" id="cb21-10" data-line-number="10">find_changepoints &lt;-<span class="st"> </span><span class="cf">function</span>(lda_model, paper_covariates, <span class="dt">n_changepoints =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb21-11" data-line-number="11">{</a>
<a class="sourceLine" id="cb21-12" data-line-number="12">  <span class="co"># set up parameters for model</span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13">  x &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(paper_covariates, </a>
<a class="sourceLine" id="cb21-14" data-line-number="14">                     year_continuous, </a>
<a class="sourceLine" id="cb21-15" data-line-number="15">                     sin_year, </a>
<a class="sourceLine" id="cb21-16" data-line-number="16">                     cos_year)</a>
<a class="sourceLine" id="cb21-17" data-line-number="17"></a>
<a class="sourceLine" id="cb21-18" data-line-number="18">  <span class="co"># run models with 1, 2, 3, 4, 5, 6 changepoints</span></a>
<a class="sourceLine" id="cb21-19" data-line-number="19">  cpt_results &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">n_changepoints =</span> n_changepoints)</a>
<a class="sourceLine" id="cb21-20" data-line-number="20">  cpt_results<span class="op">$</span>cpt_model &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(cpt_results<span class="op">$</span>n_changepoints,</a>
<a class="sourceLine" id="cb21-21" data-line-number="21">                                  <span class="cf">function</span>(n_changepoints)</a>
<a class="sourceLine" id="cb21-22" data-line-number="22">                                  {</a>
<a class="sourceLine" id="cb21-23" data-line-number="23">                                    <span class="kw">changepoint_model</span>(lda_model, x, n_changepoints, <span class="dt">maxit =</span> nit, </a>
<a class="sourceLine" id="cb21-24" data-line-number="24">                                                      <span class="dt">weights =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span>, <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span>(x)))</a>
<a class="sourceLine" id="cb21-25" data-line-number="25">                                  })</a>
<a class="sourceLine" id="cb21-26" data-line-number="26">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(cpt_results)</a>
<a class="sourceLine" id="cb21-27" data-line-number="27">}</a>
<a class="sourceLine" id="cb21-28" data-line-number="28"></a>
<a class="sourceLine" id="cb21-29" data-line-number="29"><span class="co"># Among a selection of models with different # of changepoints, </span></a>
<a class="sourceLine" id="cb21-30" data-line-number="30"><span class="co">#   - compute AIC</span></a>
<a class="sourceLine" id="cb21-31" data-line-number="31"><span class="co">#   - select the model with the best AIC</span></a>
<a class="sourceLine" id="cb21-32" data-line-number="32"><span class="co">#   - get the posterior distributions for the changepoints</span></a>
<a class="sourceLine" id="cb21-33" data-line-number="33">select_cpt_model &lt;-<span class="st"> </span><span class="cf">function</span>(cpt_results, ntopics)</a>
<a class="sourceLine" id="cb21-34" data-line-number="34">{</a>
<a class="sourceLine" id="cb21-35" data-line-number="35">  <span class="co"># compute log likelihood as the mean deviance</span></a>
<a class="sourceLine" id="cb21-36" data-line-number="36">  cpt_results<span class="op">$</span>mean_deviances &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(cpt_results<span class="op">$</span>cpt_model, </a>
<a class="sourceLine" id="cb21-37" data-line-number="37">                                       <span class="cf">function</span>(cpt_model) {<span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(cpt_model<span class="op">$</span>saved_lls)}, </a>
<a class="sourceLine" id="cb21-38" data-line-number="38">                                       <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb21-39" data-line-number="39"></a>
<a class="sourceLine" id="cb21-40" data-line-number="40">  <span class="co"># compute AIC = ( -2 * log likelihood) + 2 * (#parameters)</span></a>
<a class="sourceLine" id="cb21-41" data-line-number="41">  cpt_results<span class="op">$</span>AIC &lt;-<span class="st"> </span>cpt_results<span class="op">$</span>mean_deviances <span class="op">*</span><span class="st"> </span><span class="dv">-2</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-42" data-line-number="42"><span class="st">    </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>(ntopics <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(cpt_results<span class="op">$</span>n_changepoints <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-43" data-line-number="43"><span class="st">           </span>(cpt_results<span class="op">$</span>n_changepoints))</a>
<a class="sourceLine" id="cb21-44" data-line-number="44">  </a>
<a class="sourceLine" id="cb21-45" data-line-number="45">  <span class="co"># select the best model</span></a>
<a class="sourceLine" id="cb21-46" data-line-number="46">  cpt &lt;-<span class="st"> </span>cpt_results<span class="op">$</span>cpt_model[[<span class="kw"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span>(cpt_results<span class="op">$</span>AIC)]]</a>
<a class="sourceLine" id="cb21-47" data-line-number="47">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(cpt)</a>
<a class="sourceLine" id="cb21-48" data-line-number="48">}</a>
<a class="sourceLine" id="cb21-49" data-line-number="49"></a>
<a class="sourceLine" id="cb21-50" data-line-number="50"><span class="co"># transform the output from `compute_cpt` and match up the time indices with </span></a>
<a class="sourceLine" id="cb21-51" data-line-number="51"><span class="co">#   dates from the original data</span></a>
<a class="sourceLine" id="cb21-52" data-line-number="52">get_dates &lt;-<span class="st"> </span><span class="cf">function</span>(cpt, <span class="dt">covariates =</span> paper_covariates)</a>
<a class="sourceLine" id="cb21-53" data-line-number="53">{</a>
<a class="sourceLine" id="cb21-54" data-line-number="54">  cpt<span class="op">$</span>saved[,<span class="dv">1</span>,] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-55" data-line-number="55"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-56" data-line-number="56"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-57" data-line-number="57"><span class="st">    </span>reshape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-58" data-line-number="58"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(covariates, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"value"</span> =<span class="st"> "index"</span>))</a>
<a class="sourceLine" id="cb21-59" data-line-number="59">}</a></code></pre></div>
<div id="ldats-lda-and-paper-changepoint" class="section level3">
<h3 class="hasAnchor">
<a href="#ldats-lda-and-paper-changepoint" class="anchor"></a>LDATS LDA and paper changepoint</h3>
<p>Run the Christensen et al. time series model to identify changepoints on the LDA topics selected by LDATS:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">ldats_paper_results &lt;-<span class="st"> </span><span class="kw">find_changepoints</span>(ldats_ldamodel, paper_covariates)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(ldats_paper_results, <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"ldats_paper.RDS"</span>))</a></code></pre></div>
<p>Extract the dates of the changepoints:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">ldats_paper_results &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"ldats_paper.RDS"</span>))</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"></a>
<a class="sourceLine" id="cb23-3" data-line-number="3">ldats_paper_cpt &lt;-<span class="st"> </span><span class="kw">select_cpt_model</span>(ldats_paper_results, </a>
<a class="sourceLine" id="cb23-4" data-line-number="4">                                    <span class="dt">ntopics =</span> ldats_ldamodel<span class="op">@</span>k)</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">ldats_paper_cpt_dates &lt;-<span class="st"> </span><span class="kw">get_dates</span>(ldats_paper_cpt)</a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt; Using  as id variables</span></a></code></pre></div>
</div>
<div id="paper-lda-and-paper-changepoint" class="section level3">
<h3 class="hasAnchor">
<a href="#paper-lda-and-paper-changepoint" class="anchor"></a>Paper LDA and paper changepoint</h3>
<p>Run the Christensen et al. time series model to identify changepoints on the LDA topics selected by Christensen et al.:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">paper_paper_results &lt;-<span class="st"> </span><span class="kw">find_changepoints</span>(ldamodel, paper_covariates)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(paper_paper_results, <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"paper_paper.RDS"</span>))</a></code></pre></div>
<p>Extract the dates of the changepoints:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">paper_paper_results &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"paper_paper.RDS"</span>))</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"></a>
<a class="sourceLine" id="cb25-3" data-line-number="3">paper_paper_cpt &lt;-<span class="st"> </span><span class="kw">select_cpt_model</span>(paper_paper_results, </a>
<a class="sourceLine" id="cb25-4" data-line-number="4">                                    <span class="dt">ntopics =</span> ldamodel<span class="op">@</span>k)</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">paper_paper_cpt_dates &lt;-<span class="st"> </span><span class="kw">get_dates</span>(ldats_paper_cpt)</a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="co">#&gt; Using  as id variables</span></a></code></pre></div>
</div>
</div>
<div id="running-ldats-changepoint-models" class="section level2">
<h2 class="hasAnchor">
<a href="#running-ldats-changepoint-models" class="anchor"></a>Running LDATS changepoint models</h2>
<div id="ldats-lda-and-ldats-changepoint" class="section level3">
<h3 class="hasAnchor">
<a href="#ldats-lda-and-ldats-changepoint" class="anchor"></a>LDATS LDA and LDATS changepoint</h3>
<p>Run the LDATS time series model to identify changepoints on the LDA topics selected by LDATS:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">ldats_ldats_results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/TS_on_LDA.html">TS_on_LDA</a></span>(<span class="dt">LDA_models =</span> ldats_ldamodel,</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">                                 <span class="dt">document_covariate_table =</span> rodents<span class="op">$</span>document_covariate_table,</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">                                 <span class="dt">formulas =</span> <span class="op">~</span><span class="st"> </span>sin_year <span class="op">+</span><span class="st"> </span>cos_year,</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">                                 <span class="dt">nchangepoints =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">                                 <span class="dt">timename =</span> <span class="st">"newmoon"</span>,</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">                                 <span class="dt">weights =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb26-7" data-line-number="7">                                 <span class="dt">control =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">nit =</span> nit))</a>
<a class="sourceLine" id="cb26-8" data-line-number="8"></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(ldats_ldats_results, <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"ldats_ldats.RDS"</span>))</a></code></pre></div>
<p>Unlike the paper changepoint model, LDATS can recognize that sampling periods may not be equidistant, and can place changepoint estimates at new moons if they fall between nonconsecutive sampling periods. We can estimate the dates corresponding to those new moons, extrapolating from the census dates for adjacent census periods.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># make the full sequence of possible newmoon values</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">full_index &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(rodents<span class="op">$</span>document_covariate_table<span class="op">$</span>newmoon), </a>
<a class="sourceLine" id="cb27-3" data-line-number="3">                  <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(rodents<span class="op">$</span>document_covariate_table<span class="op">$</span>newmoon))</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co"># generate a lookup table with dates for the newmoons, using `approx` to </span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="co">#   linearly interpolate the missing values</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7">ldats_dates &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span>(rodents<span class="op">$</span>document_covariate_table<span class="op">$</span>newmoon, </a>
<a class="sourceLine" id="cb27-8" data-line-number="8">                     <span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(rodents<span class="op">$</span>document_covariate_table<span class="op">$</span>date), </a>
<a class="sourceLine" id="cb27-9" data-line-number="9">                     full_index) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">index =</span> x, </a>
<a class="sourceLine" id="cb27-12" data-line-number="12">         <span class="dt">date =</span> <span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(y, <span class="dt">origin =</span> <span class="st">"1970-01-01"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="st">  </span><span class="kw">select</span>(index, date)</a></code></pre></div>
<p>Select the best time series model and extract the dates of the changepoints:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">ldats_ldats_results &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"ldats_ldats.RDS"</span>))</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb28-3" data-line-number="3">ldats_ldats_cpt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/select_TS.html">select_TS</a></span>(ldats_ldats_results)</a>
<a class="sourceLine" id="cb28-4" data-line-number="4"></a>
<a class="sourceLine" id="cb28-5" data-line-number="5">ldats_ldats_cpt_dates &lt;-<span class="st"> </span>ldats_ldats_cpt<span class="op">$</span>rhos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="st">  </span>reshape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(ldats_dates, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"value"</span> =<span class="st"> "index"</span>))</a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="co">#&gt; Using  as id variables</span></a></code></pre></div>
</div>
<div id="paper-lda-and-ldats-changepoint" class="section level3">
<h3 class="hasAnchor">
<a href="#paper-lda-and-ldats-changepoint" class="anchor"></a>Paper LDA and LDATS changepoint</h3>
<p>Run the LDATS time series model to identify changepoints on the LDA topics selected by Christensen et al.:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">paper_ldats_results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/TS_on_LDA.html">TS_on_LDA</a></span>(<span class="dt">LDA_models =</span> ldamodel,</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">                             <span class="dt">document_covariate_table =</span> rodents<span class="op">$</span>document_covariate_table,</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">                             <span class="dt">formulas =</span> <span class="op">~</span><span class="st"> </span>sin_year <span class="op">+</span><span class="st"> </span>cos_year,</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">                             <span class="dt">nchangepoints =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,</a>
<a class="sourceLine" id="cb29-5" data-line-number="5"></a>
<a class="sourceLine" id="cb29-6" data-line-number="6">                             <span class="dt">timename =</span> <span class="st">"newmoon"</span>,</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">                             <span class="dt">weights =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb29-8" data-line-number="8">                             <span class="dt">control =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">nit =</span> nit))</a>
<a class="sourceLine" id="cb29-9" data-line-number="9"></a>
<a class="sourceLine" id="cb29-10" data-line-number="10"></a>
<a class="sourceLine" id="cb29-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span>(paper_ldats_results, <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"paper_ldats.RDS"</span>))</a></code></pre></div>
<p>Select the best time series model and extract the dates of the changepoints:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">paper_ldats_results &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(vignette_files, <span class="st">"paper_ldats.RDS"</span>))</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb30-3" data-line-number="3">paper_ldats_cpt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/select_TS.html">select_TS</a></span>(paper_ldats_results)</a>
<a class="sourceLine" id="cb30-4" data-line-number="4"></a>
<a class="sourceLine" id="cb30-5" data-line-number="5">paper_ldats_cpt_dates &lt;-<span class="st"> </span>paper_ldats_cpt<span class="op">$</span>rhos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"><span class="st">  </span>reshape<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(ldats_dates, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"value"</span> =<span class="st"> "index"</span>))</a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="co">#&gt; Using  as id variables</span></a></code></pre></div>
</div>
</div>
<div id="how-many-changepoints-were-identified" class="section level2">
<h2 class="hasAnchor">
<a href="#how-many-changepoints-were-identified" class="anchor"></a>How many changepoints were identified?</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span>(ldats_paper_cpt_dates<span class="op">$</span>variable)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="co">#&gt; [1] 4</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span>(paper_paper_cpt_dates<span class="op">$</span>variable)</a>
<a class="sourceLine" id="cb31-4" data-line-number="4"><span class="co">#&gt; [1] 4</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span>(ldats_ldats_cpt_dates<span class="op">$</span>variable)</a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="co">#&gt; [1] 4</span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span>(paper_ldats_cpt_dates<span class="op">$</span>variable)</a>
<a class="sourceLine" id="cb31-8" data-line-number="8"><span class="co">#&gt; [1] 4</span></a></code></pre></div>
<p>All of the models find four changepoints.</p>
</div>
<div id="plot-changepoint-models" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-changepoint-models" class="anchor"></a>Plot changepoint models</h2>
<div id="paper-lda-and-ldats-changepoint-1" class="section level3">
<h3 class="hasAnchor">
<a href="#paper-lda-and-ldats-changepoint-1" class="anchor"></a>Paper LDA and LDATS changepoint</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(paper_ldats_cpt)</a></code></pre></div>
<p><img src="paper-comparison_files/figure-html/plot%20paper%20LDA%20and%20LDATS%20cpts-1.png" width="672"></p>
</div>
<div id="ldats-lda-and-ldats-changepoint-1" class="section level3">
<h3 class="hasAnchor">
<a href="#ldats-lda-and-ldats-changepoint-1" class="anchor"></a>LDATS LDA and LDATS changepoint</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(ldats_ldats_cpt)</a></code></pre></div>
<p><img src="paper-comparison_files/figure-html/plot%20ldats%20LDA%20and%20LDATS%20cpt-1.png" width="672"></p>
</div>
<div id="paper-lda-and-paper-changepoint-1" class="section level3">
<h3 class="hasAnchor">
<a href="#paper-lda-and-paper-changepoint-1" class="anchor"></a>Paper LDA and paper changepoint</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">paper_cpts &lt;-<span class="st"> </span><span class="kw">find_changepoint_location</span>(paper_paper_cpt)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">ntopics &lt;-<span class="st"> </span>ldamodel<span class="op">@</span>k</a>
<a class="sourceLine" id="cb34-3" data-line-number="3"></a>
<a class="sourceLine" id="cb34-4" data-line-number="4">paper_cpt_plot &lt;-<span class="st"> </span><span class="kw">get_ll_non_memoized_plot</span>(ldamodel, paper_covariates, paper_cpts, <span class="dt">make_plot =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">                                           <span class="dt">weights =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span>, <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span>(paper_covariates)))</a>
<a class="sourceLine" id="cb34-6" data-line-number="6"></a>
<a class="sourceLine" id="cb34-7" data-line-number="7"><span class="kw">annual_hist</span>(paper_paper_cpt, paper_covariates<span class="op">$</span>year_continuous)</a></code></pre></div>
<p><img src="paper-comparison_files/figure-html/plot%20paper%20LDA%20and%20paper%20cpt-1.png" width="672"></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">paper_cpt_plot</a></code></pre></div>
<p><img src="paper-comparison_files/figure-html/plot%20paper%20LDA%20and%20paper%20cpt-2.png" width="672"></p>
</div>
<div id="ldats-lda-and-paper-changepoint-1" class="section level3">
<h3 class="hasAnchor">
<a href="#ldats-lda-and-paper-changepoint-1" class="anchor"></a>LDATS LDA and paper changepoint</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">ldats_cpts &lt;-<span class="st"> </span><span class="kw">find_changepoint_location</span>(ldats_paper_cpt)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">ntopics &lt;-<span class="st"> </span>ldats_ldamodel<span class="op">@</span>k</a>
<a class="sourceLine" id="cb36-3" data-line-number="3"></a>
<a class="sourceLine" id="cb36-4" data-line-number="4">ldats_cpt_plot &lt;-<span class="st"> </span><span class="kw">get_ll_non_memoized_plot</span>(ldats_ldamodel, paper_covariates, ldats_cpts, <span class="dt">make_plot =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb36-5" data-line-number="5">                                           <span class="dt">weights =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span>, <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span>(paper_covariates)))</a>
<a class="sourceLine" id="cb36-6" data-line-number="6"></a>
<a class="sourceLine" id="cb36-7" data-line-number="7"><span class="kw">annual_hist</span>(ldats_paper_cpt, paper_covariates<span class="op">$</span>year_continuous)</a></code></pre></div>
<p><img src="paper-comparison_files/figure-html/plot%20LDATS%20lda%20and%20paper%20cpt-1.png" width="672"></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">ldats_cpt_plot</a></code></pre></div>
<p><img src="paper-comparison_files/figure-html/plot%20LDATS%20lda%20and%20paper%20cpt-2.png" width="672"></p>
<p>The results of the changepoint model appear robust to both choice of LDA model and choice of changepoint model.</p>
</div>
</div>
<div id="report-changepoint-dates" class="section level2">
<h2 class="hasAnchor">
<a href="#report-changepoint-dates" class="anchor"></a>Report changepoint dates</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(cpt_dates)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">changepoint</th>
<th align="left">ldatsLDA_ldatsCPT</th>
<th align="left">ldatsLDA_paperCPT</th>
<th align="left">paperLDA_ldatsCPT</th>
<th align="left">paperLDA_paperCPT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">V1</td>
<td align="left">1984-01-30</td>
<td align="left">1984-01-11</td>
<td align="left">1984-04-27</td>
<td align="left">1984-01-11</td>
</tr>
<tr class="even">
<td align="left">V2</td>
<td align="left">1991-05-30</td>
<td align="left">1991-05-29</td>
<td align="left">1993-04-19</td>
<td align="left">1991-05-29</td>
</tr>
<tr class="odd">
<td align="left">V3</td>
<td align="left">1999-01-25</td>
<td align="left">1998-12-21</td>
<td align="left">1999-07-07</td>
<td align="left">1998-12-21</td>
</tr>
<tr class="even">
<td align="left">V4</td>
<td align="left">2009-11-15</td>
<td align="left">2009-09-29</td>
<td align="left">2010-01-20</td>
<td align="left">2009-09-29</td>
</tr>
</tbody>
</table>
<p>The choice of LDA has more influence on the changepoint locations than the choice of changepoint model - probably because the LDATS LDA has 6 topics, and the paper LDA has 4. However, all of the models agree to within 6 months in most cases, and a year for the broader early 1990s changepoint.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#introduction">Introduction</a><ul class="nav nav-pills nav-stacked">
<li><a href="#summary">Summary</a></li>
      </ul>
</li>
      <li>
<a href="#setup">Setup</a><ul class="nav nav-pills nav-stacked">
<li><a href="#ldats-installation">LDATS Installation</a></li>
      <li><a href="#running-the-models">Running the Models</a></li>
      <li><a href="#download-analysis-scripts-and-data-files">Download Analysis Scripts and Data Files</a></li>
      <li><a href="#download-model-outputs">Download Model Outputs</a></li>
      </ul>
</li>
      <li>
<a href="#data-comparison">Data Comparison</a><ul class="nav nav-pills nav-stacked">
<li><a href="#compare-the-data-from-christensen-et-al-with-the-included-data-in-ldats">Compare the data from Christensen et al. with the included data in <code>LDATS</code></a></li>
      </ul>
</li>
      <li>
<a href="#identify-community-groups-using-lda">Identify community groups using LDA</a><ul class="nav nav-pills nav-stacked">
<li><a href="#plots">Plots</a></li>
      </ul>
</li>
      <li>
<a href="#changepoint-models">Changepoint models</a><ul class="nav nav-pills nav-stacked">
<li><a href="#running-paper-changepoint-models">Running paper changepoint models</a></li>
      <li><a href="#running-ldats-changepoint-models">Running LDATS changepoint models</a></li>
      <li><a href="#how-many-changepoints-were-identified">How many changepoints were identified?</a></li>
      <li><a href="#plot-changepoint-models">Plot changepoint models</a></li>
      <li><a href="#report-changepoint-dates">Report changepoint dates</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Juniper L. Simonis, Erica M. Christensen, David J. Harris, Renata M. Diaz, Hao Ye, Ethan P. White, S.K. Morgan Ernest.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
